"""
Investment Reasoning Generator
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –ø–æ—á–µ–º—É –∏–≥—Ä–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞
"""


def generate_investment_reasoning(game_data: dict, analysis_result: dict) -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    """
    
    title = game_data.get('title', '–ò–≥—Ä–∞')
    pp = analysis_result['product_potential']
    gtm = analysis_result['gtm_execution']
    gap = analysis_result['gap_score']
    fix = analysis_result['fixability']['fixability_score']
    category = analysis_result['investor_category']
    
    narrative = analysis_result['narrative_level']
    pattern = analysis_result['dramatic_pattern']
    
    primary_level = narrative.get('primary_level')
    primary_pattern = pattern.get('primary_pattern')
    
    # –ü–µ—Ä–µ–≤–æ–¥—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
    level_names = {
        'biological': '–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º —É—Ä–æ–≤–Ω–µ (–≤—ã–∂–∏–≤–∞–Ω–∏–µ)',
        'social': '—Å–æ—Ü–∏–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ (–æ—Ç–Ω–æ—à–µ–Ω–∏—è)',
        'identity': '—É—Ä–æ–≤–Ω–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ (—Å–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)',
        'meta': '–º–µ—Ç–∞-—É—Ä–æ–≤–Ω–µ (–æ—Å–æ–∑–Ω–∞–Ω–∏–µ)'
    }
    
    pattern_names = {
        'threat_to_safety': '–£–≥—Ä–æ–∑–∞ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–≤—ã–∂–∏–≤–∞–Ω–∏–µ)',
        'weak_to_strong': '–°–ª–∞–±—ã–π ‚Üí –°–∏–ª—å–Ω—ã–π (–ø—Ä–æ–∫–∞—á–∫–∞)',
        'chaos_to_order': '–•–∞–æ—Å ‚Üí –ü–æ—Ä—è–¥–æ–∫ (—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ)',
        'loss_to_compensation': '–ü–æ—Ç–µ—Ä—è ‚Üí –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)',
        'forbidden_to_violation': '–ó–∞–ø—Ä–µ—Ç ‚Üí –ù–∞—Ä—É—à–µ–Ω–∏–µ (—Å–≤–æ–±–æ–¥–∞)',
        'humiliation_to_revenge': '–£–Ω–∏–∂–µ–Ω–∏–µ ‚Üí –ú–µ—Å—Ç—å (–≤–æ–∑–º–µ–∑–¥–∏–µ)',
        'mystery_to_revelation': '–¢–∞–π–Ω–∞ ‚Üí –û—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ (–ø–æ–∑–Ω–∞–Ω–∏–µ)'
    }
    
    level_desc = level_names.get(primary_level, '—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ')
    pattern_desc = pattern_names.get(primary_pattern, '—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞')
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    
    if category == 'undermarketed_gem':
        reasoning = f"""
üíé **–ù–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—ã–π —à–µ–¥–µ–≤—Ä** ‚Äî —ç—Ç–æ —Ä–µ–¥–∫–∞—è –Ω–∞—Ö–æ–¥–∫–∞!

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
–ò–≥—Ä–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ {level_desc} —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º "{pattern_desc}". –¢–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞—Ü–µ–ø–ª—è—é—Ç –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ –ø–æ–¥—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ –∏ —Å–æ–∑–¥–∞—é—Ç –≤—ã—Å–æ–∫—É—é retention.

**–ü—Ä–æ–¥—É–∫—Ç —Å–∏–ª—å–Ω—ã–π (PP {pp}/10):** –ù–∞—Ä—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω —á—ë—Ç–∫–æ –≤—ã—Ä–∞–∂–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≥–µ–π–º–ø–ª–µ–µ. –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∂–∏—Ç—å —ç—Ç—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é.

**–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ —Å–ª–∞–±—ã–π (GTM {gtm}/10):** –ù–æ —Ä—ã–Ω–æ–∫ –æ–± —ç—Ç–æ–º –Ω–µ –∑–Ω–∞–µ—Ç! –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤ –ø—Ä–æ—Å—Ç–æ –Ω–µ –≤–∏–¥—è—Ç –∏–≥—Ä—É –∏–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –µ—ë —Ü–µ–Ω–Ω–æ—Å—Ç—å.

**–†–∞–∑—Ä—ã–≤ –æ–≥—Ä–æ–º–Ω—ã–π (GAP {gap}):** –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–µ–±–æ–ª—å—à–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –º–æ–≥—É—Ç –¥–∞—Ç—å –≤–∑—Ä—ã–≤–Ω–æ–π —Ä–æ—Å—Ç –ø—Ä–æ–¥–∞–∂. –ü—Ä–æ–¥—É–∫—Ç –≥–æ—Ç–æ–≤, –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ–≥–æ –ø–æ–∫–∞–∑–∞—Ç—å.

**–õ–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (FIX {fix}/10):** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–µ–Ω—è—Ç—å –≥–µ–π–º–ø–ª–µ–π. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å —Ç—Ä–µ–π–ª–µ—Ä, –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –¥–µ–º–æ –∑–∞ 30-45 –¥–Ω–µ–π. **–û–∂–∏–¥–∞–µ–º—ã–π ROI: 5x-10x.**
"""
    
    elif category == 'marketing_fixable':
        reasoning = f"""
üîß **–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏—Å–ø—Ä–∞–≤–∏–º** ‚Äî —Ö–æ—Ä–æ—à–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å.

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
–ò–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ {level_desc} —á–µ—Ä–µ–∑ –ø–∞—Ç—Ç–µ—Ä–Ω "{pattern_desc}". –≠—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω—è—Ç–µ–Ω —à–∏—Ä–æ–∫–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.

**–ü—Ä–æ–¥—É–∫—Ç —Ö–æ—Ä–æ—à–∏–π (PP {pp}/10):** –ù–∞—Ä—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –µ—Å—Ç—å –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ö–æ—Ç—è –º–æ–≥ –±—ã –±—ã—Ç—å –≤—ã—Ä–∞–∂–µ–Ω —Å–∏–ª—å–Ω–µ–µ. –ò–≥—Ä–æ–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω—É–∂–Ω—É—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —ç—Ç–æ –æ—á–µ–≤–∏–¥–Ω–æ —Å—Ä–∞–∑—É.

**–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω (GTM {gtm}/10):** –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –∏–≥—Ä—ã –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç –µ—ë –∫–ª—é—á–µ–≤—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç, **—á—Ç–æ –æ–Ω–∏ –ø–æ–ª—É—á–∞—Ç** –æ—Ç –∏–≥—Ä—ã.

**–ï—Å—Ç—å —Ä–∞–∑—Ä—ã–≤ (GAP {gap}):** –£–ª—É—á—à–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —Ä–æ—Å—Ç—É –ø—Ä–æ–¥–∞–∂, —Ö–æ—Ç—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –Ω–µ —Ç–∞–∫–æ–π –≤–∑—Ä—ã–≤–Ω–æ–π –∫–∞–∫ —É "—à–µ–¥–µ–≤—Ä–æ–≤".

**–ò—Å–ø—Ä–∞–≤–∏–º–æ (FIX {fix}/10):** –ó–∞ 30-60 –¥–Ω–µ–π –º–æ–∂–Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. **–û–∂–∏–¥–∞–µ–º—ã–π ROI: 2x-4x.**
"""
    
    elif category == 'product_risk':
        reasoning = f"""
‚ö†Ô∏è **–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π —Ä–∏—Å–∫** ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–æ–∑–¥–µ—Ä–∂–∞—Ç—å—Å—è –æ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π.

**–ü—Ä–æ–±–ª–µ–º–∞ –≤ –ø—Ä–æ–¥—É–∫—Ç–µ:**
–•–æ—Ç—è –∏–≥—Ä–∞ –ø—ã—Ç–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ {level_desc} –∏ –ø–∞—Ç—Ç–µ—Ä–Ω "{pattern_desc}", —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–±–∞—è.

**–ü—Ä–æ–¥—É–∫—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏–ª—ë–Ω (PP {pp}/10):** –ù–∞—Ä—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –ª–∏–±–æ –Ω–µ –≤—ã—Ä–∞–∂–µ–Ω –≤ –≥–µ–π–º–ø–ª–µ–µ, –ª–∏–±–æ —Ä–∞–∑–º—ã—Ç, –ª–∏–±–æ –Ω–µ —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç —Å –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π.

**–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–µ –ø–æ–º–æ–∂–µ—Ç (GTM {gtm}/10):** –î–∞–∂–µ –µ—Å–ª–∏ —É–ª—É—á—à–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é, —ç—Ç–æ –Ω–µ —Ä–µ—à–∏—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É ‚Äî –∏–≥—Ä–∞ –Ω–µ –¥–∞—ë—Ç –∏–≥—Ä–æ–∫–∞–º –Ω—É–∂–Ω—É—é —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é.

**–ù–∏–∑–∫–∞—è –∏—Å–ø—Ä–∞–≤–∏–º–æ—Å—Ç—å (FIX {fix}/10):** –ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç, –Ω—É–∂–µ–Ω —Ä–µ–¥–∏–∑–∞–π–Ω –≥–µ–π–º–ø–ª–µ—è, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –º–µ—Å—è—Ü—ã —Ä–∞–±–æ—Ç—ã –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –±—é–¥–∂–µ—Ç.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å. –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–µ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —Å–ª–∞–±—ã–π –ø—Ä–æ–¥—É–∫—Ç.
"""
    
    else:  # not_investable
        reasoning = f"""
‚ùå **–ù–µ –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–µ–º–æ** ‚Äî –Ω–µ—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

**–°–∏—Ç—É–∞—Ü–∏—è:**
–ò–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ {level_desc}, –Ω–æ –ª–∏–±–æ –ø—Ä–æ–¥—É–∫—Ç —Å–ª–∞–±—ã–π (PP {pp}/10), –ª–∏–±–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ —É–∂–µ —Ö–æ—Ä–æ—à–∏–π (GTM {gtm}/10), –ª–∏–±–æ —Ä–∞–∑—Ä—ã–≤ —Å–ª–∏—à–∫–æ–º –º–∞–ª (GAP {gap}).

**–ü–æ—á–µ–º—É –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º:**
- –ï—Å–ª–∏ PP –Ω–∏–∑–∫–∏–π ‚Äî –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –¥–∞—ë—Ç –Ω—É–∂–Ω—É—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–≥—Ä–æ–∫–∞–º
- –ï—Å–ª–∏ GTM –≤—ã—Å–æ–∫–∏–π ‚Äî –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ —É–∂–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, —É–ª—É—á—à–∞—Ç—å –Ω–µ—á–µ–≥–æ
- –ï—Å–ª–∏ GAP –º–∞–ª–µ–Ω—å–∫–∏–π ‚Äî –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –Ω–µ –ø—Ä–∏–Ω–µ—Å—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —Ä–æ—Å—Ç

**–í—ã–≤–æ–¥:** –õ–∏–±–æ –ø—Ä–æ–¥—É–∫—Ç –Ω–µ –≥–æ—Ç–æ–≤, –ª–∏–±–æ —É–∂–µ —É—Å–ø–µ—à–µ–Ω, –ª–∏–±–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞ –º–∏–Ω–∏–º–∞–ª–µ–Ω.
"""
    
    return reasoning.strip()


def generate_short_pitch(game_data: dict, analysis_result: dict) -> str:
    """
    –ö—Ä–∞—Ç–∫–∏–π elevator pitch –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
    """
    
    title = game_data.get('title', '–ò–≥—Ä–∞')
    pp = analysis_result['product_potential']
    gap = analysis_result['gap_score']
    category = analysis_result['investor_category']
    
    if category == 'undermarketed_gem':
        return f"–°–∏–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç (PP {pp}) —Å –æ–≥—Ä–æ–º–Ω—ã–º —Ä–∞–∑—Ä—ã–≤–æ–º (GAP {gap}) ‚Äî –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–∏–Ω–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞ 30 –¥–Ω–µ–π, ROI 5-10x."
    
    elif category == 'marketing_fixable':
        return f"–•–æ—Ä–æ—à–∏–π –ø—Ä–æ–¥—É–∫—Ç (PP {pp}) —Å–æ —Å—Ä–µ–¥–Ω–∏–º —Ä–∞–∑—Ä—ã–≤–æ–º (GAP {gap}) ‚Äî –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å. ROI 2-4x –∑–∞ 45 –¥–Ω–µ–π."
    
    elif category == 'product_risk':
        return f"–°–ª–∞–±—ã–π –ø—Ä–æ–¥—É–∫—Ç (PP {pp}) ‚Äî –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –Ω–µ –ø–æ–º–æ–∂–µ—Ç. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º."
    
    else:
        return f"–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π (PP {pp}, GAP {gap})."
